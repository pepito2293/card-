<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte √† gratter interactive</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Calibri, Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh; /* Assure que le contenu tient dans la hauteur de la fen√™tre */
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f8d5e2;
            overflow: hidden; /* √âvite tout d√©filement */
        }
        .container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: center;
        }
        .title {
            font-size: 5vh; /* Taille du texte relative √† la hauteur de la fen√™tre */
            color: #d32f2f;
            margin: 0;
            font-weight: bold;
        }
        .card-container {
            width: 90%;
            max-width: 800px;
            height: 75%; /* La carte occupe 75% de la hauteur disponible */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            background: #fff;
            padding: 2%;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .result {
            padding: 10px 20px;
            background: #4CAF50;
            color: #fff;
            font-size: 2vh; /* Taille du texte ajust√©e √† la hauteur */
            font-weight: bold;
            border-radius: 10px;
            text-align: center;
            display: none; /* Cacher le r√©sultat au d√©part */
        }
        .card {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1vh; /* Espace entre les cases bas√© sur la hauteur */
            width: 100%;
            height: 100%;
        }
        .scratch-card {
            width: 100%;
            aspect-ratio: 1; /* Assure que les cases sont carr√©es */
            background-color: gold;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .scratch-card:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        .scratch-card .content {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2vh; /* Texte ajust√© √† la hauteur */
            font-weight: bold;
            color: #fff;
            z-index: 1;
        }
        .scratch-card .hidden {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: gold;
            z-index: 2;
        }
        .instructions {
            padding: 10px;
            background-color: #fdd835;
            border-radius: 15px;
            text-align: left;
            font-size: 1.8vh; /* Texte adapt√© √† la hauteur */
            font-weight: bold;
            width: 100%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Carte √† gratter interactive</div>
        
        <!-- Section pour la carte -->
        <div class="card-container">
            <!-- R√©sultat affich√© en haut de la carte -->
            <div class="result" id="result"></div>

            <!-- La carte blanche -->
            <div class="card">
                <div id="grid" class="grid"></div>
            </div>

            <!-- Instructions en bas -->
            <div class="instructions">
                <p>‚úàÔ∏è x3 = Un voyage</p>
                <p>üçΩÔ∏è x3 = Un resto</p>
                <p>üíÜ x3 = Un massage</p>
                <p>üé¨ x3 = Une soir√©e Netflix</p>
            </div>
        </div>
    </div>

    <script>
        const rewards = ["‚úàÔ∏è", "üçΩÔ∏è", "üíÜ", "üé¨"]; // Les smileys possibles
        let revealedCards = 0; // Compte des cases gratt√©es
        let rewardCounts = {}; // Compte des r√©compenses visibles

        function generateRandomRewards() {
            const grid = document.getElementById("grid");
            grid.innerHTML = ""; // R√©initialise la grille
            revealedCards = 0;
            rewardCounts = {};

            const rewardPool = createRandomRewardPool();
            rewardPool.forEach((reward) => {
                const scratchCard = document.createElement("div");
                scratchCard.classList.add("scratch-card");
                scratchCard.innerHTML = `
                    <div class="hidden"></div>
                    <div class="content">${reward}</div>
                `;
                scratchCard.addEventListener("click", () => scratchCardReveal(scratchCard, reward));
                grid.appendChild(scratchCard);
            });
        }

        function createRandomRewardPool() {
            const winningReward = rewards[Math.floor(Math.random() * rewards.length)];
            const rewardPool = [winningReward, winningReward, winningReward]; // Le gagnant x3
            const otherRewards = rewards.filter((reward) => reward !== winningReward);
            otherRewards.forEach((reward) => rewardPool.push(reward, reward)); // Les autres x2
            return shuffleArray(rewardPool); // M√©langer
        }

        function scratchCardReveal(card, reward) {
            const hiddenLayer = card.querySelector(".hidden");
            if (hiddenLayer) {
                hiddenLayer.style.transition = "opacity 0.5s";
                hiddenLayer.style.opacity = 0;
                setTimeout(() => hiddenLayer.remove(), 500);

                revealedCards++;
                rewardCounts[reward] = (rewardCounts[reward] || 0) + 1;

                // V√©rifier si toutes les cases sont gratt√©es
                if (revealedCards === 9) {
                    displayResult();
                }
            }
        }

        function displayResult() {
            const resultContainer = document.getElementById("result");
            resultContainer.style.display = "block";

            // Trouver le gagnant
            const winner = Object.entries(rewardCounts).find(([reward, count]) => count === 3);
            if (winner) {
                resultContainer.textContent = `üéâ Le gagnant est : ${winner[0]} !`;
            } else {
                resultContainer.textContent = "Aucun gagnant trouv√©. Essayez une nouvelle carte !";
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // G√©n√©rer une nouvelle combinaison au chargement de la page
        window.onload = generateRandomRewards;
    </script>
</body>
</html>
